(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,function(e,t,a){e.exports={wrapper:"Chat_wrapper__2s4wS",Chat:"Chat_Chat__2PyNt",topSection:"Chat_topSection__3qrAt",Messages:"Chat_Messages__2zESZ",OnlineUsers:"Chat_OnlineUsers__2klAx",usersTitle:"Chat_usersTitle__1DCtG",Form:"Chat_Form__28taY"}},function(e,t,a){e.exports={SingleMessage:"SingleMessage_SingleMessage__2L7Mp",from:"SingleMessage_from__2rDQB",body:"SingleMessage_body__2pwJv",blue:"SingleMessage_blue__3uVFQ"}},,,,,,,,function(e,t,a){e.exports={App:"App_App__1XRpf"}},function(e,t,a){e.exports={wrapper:"ModalUserName_wrapper__1vLwQ"}},function(e,t,a){e.exports={Messages:"Messages_Messages__LRaPM"}},,function(e,t,a){e.exports=a(21)},,,,,,function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(9),o=a.n(r),c=(a(20),a(3)),l=a(4),i=a(6),m=a(5),u=a(7),p=a(10),f=a.n(p),g=a(11),d=a.n(g),_=function(e){var t=e.setUserNameHandler;return s.a.createElement("div",{className:d.a.wrapper},s.a.createElement("form",{onSubmit:t},s.a.createElement("input",{type:"text",placeholder:"Your nickname",name:"nickname"}),s.a.createElement("button",{type:"submit"},"Ok")))},h=a(13),v=a(1),b=a.n(v),N=a(2),S=a.n(N),E=function(e){var t,a,r=e.msg;return Object(n.useContext)(k)!==r.from?(t=s.a.createElement("div",{className:S.a.from},r.from),a=S.a.SingleMessage):a="".concat(S.a.SingleMessage," ").concat(S.a.blue),s.a.createElement("li",{className:a},t,s.a.createElement("div",{className:S.a.body},r.body))},O=a(12),y=a.n(O),w=function(e){var t=Object(n.useRef)(null);return Object(n.useEffect)(function(){t.current.scrollTop=t.current.scrollHeight},[e.messages]),s.a.createElement("ul",{ref:t,className:y.a.Messages},e.messages.map(function(e,t){return s.a.createElement(E,{key:t,msg:e})}))},M=function(e){var t=e.user;return s.a.createElement("li",null,t)},C=function(e){var t=e.users;return s.a.createElement("ul",null,t.map(function(e,t){return s.a.createElement(M,{key:t,user:e})}))},x=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(i.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(s)))).state={messages:[],onlineUsers:[]},a.ws=null,a.sid=null,a.handleSubmit=function(e){e.preventDefault();var t={bc:"maxchat",msg:e.target.elements.msg.value};e.target.elements.msg.value="",a.ws.send(JSON.stringify(t))},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.ws=new WebSocket("ws://achex.ca:4010");var t=this.ws;t.onopen=function(e){console.log(e)},t.onclose=function(a){a.wasClean?console.log("Closed correctly"):console.log("Connection broke"),console.log("Code: ".concat(a.code,", reason: ").concat(a.reason)),t.send(JSON.stringify({bc:"maxchat",offline:e.props.userName}))},t.onerror=function(e){console.log(e.message)},t.onmessage=function(a){console.log(a.data);var n=JSON.parse(a.data);if(n.SID){e.SID=n.SID;var s={setID:e.props.userName,passwd:"12345678"};t.send(JSON.stringify(s))}if(n.auth&&(console.log(n.auth),t.send(JSON.stringify({cmd:"register_broadcast",bid:"maxchat"})),t.send(JSON.stringify({bc:"maxchat",online:e.props.userName,req:"info"}))),n.msg){var r={from:n.FROM,body:n.msg};e.setState({messages:e.state.messages.concat(r)})}if(n.online&&(e.state.onlineUsers.includes(n.online)||(n.online!==e.props.userName&&t.send(JSON.stringify({bc:"maxchat",online:e.props.userName,req:"info"})),e.setState({onlineUsers:e.state.onlineUsers.concat(n.online)}))),n.offline){var o=Object(h.a)(e.state.onlineUsers),c=o.indexOf(n.offline);o.splice(c,1),e.setState({onlineUsers:o})}}}},{key:"render",value:function(){return s.a.createElement("div",{className:b.a.wrapper},s.a.createElement("div",{className:b.a.Chat},s.a.createElement("div",{className:b.a.topSection},s.a.createElement("div",{className:b.a.Messages},s.a.createElement(w,{messages:this.state.messages})),s.a.createElement("div",{className:b.a.OnlineUsers},s.a.createElement("div",{className:b.a.usersTitle},"Online users:"),s.a.createElement(C,{users:this.state.onlineUsers}))),s.a.createElement("form",{className:b.a.Form,onSubmit:this.handleSubmit},s.a.createElement("input",{type:"text",placeholder:"Message...",name:"msg"}),s.a.createElement("button",{type:"submit"},"Send"))))}}]),t}(n.Component),k=s.a.createContext(""),U=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(i.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(s)))).state={userName:""},a.setUserNameHandler=function(e){e.preventDefault(),e.target.elements.nickname.value&&a.setState({userName:e.target.elements.nickname.value})},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e,t,a=this.state.userName,n=this.setUserNameHandler;return this.state.userName?t=s.a.createElement(x,{userName:a}):e=s.a.createElement(_,{userName:a,setUserNameHandler:n}),s.a.createElement(k.Provider,{value:this.state.userName},s.a.createElement("div",{className:f.a.App},e,t))}}]),t}(n.Component);o.a.render(s.a.createElement(U,null),document.getElementById("root"))}],[[14,1,2]]]);
//# sourceMappingURL=main.2919804b.chunk.js.map